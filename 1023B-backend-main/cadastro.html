<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="style.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,300,0,0&icon_names=sports_basketball" />
  <title>Cadastrar Atletas</title>
</head>
<body>
  <header>
    <span class="material-symbols-outlined">sports_basketball</span>
    <h1>CADASTRE SEU ATLETA</h1>
    <nav>
      <a href="index.html">ATLETAS</a>
      <a href="cadastro.html">CADASTRE</a>
      <a href="comparar.html">COMPARAR</a>
      <a href="destaques.html">DESTAQUES</a>
      <a href="listar.html">LISTA</a>
    </nav>
  </header>


<div id="formulario">
    <h2>Formulário de Cadastro</h2>
    <form onsubmit="event.preventDefault();trataForma()">
        <label>Id</label>
        <input type="number" id="id" name="id" placeholder="id" required oninvalid="this.setCustomValidity('Por favor, preencha o ID')"
        oninput="this.setCustomValidity('')">
        <label>Nome</label>
        <input type="text" name="nome" id="nome" placeholder="Ex: nome" required oninvalid="this.setCustomValidity('Por favor, preencha o nome')"
        oninput="this.setCustomValidity('')">
        <label>Idade</label>
        <input type="number" name="idade" id="idade" placeholder="Ex: 18"min="5" max="80" required
         oninvalid="this.setCustomValidity('Informe uma idade válida (entre 5 e 80)')"
        oninput="this.setCustomValidity('')">
        <label>Posição</label>
        <input type="text" name="posicao" id="posicao" placeholder="Ex: Pivô" required oninvalid="this.setCustomValidity('Por favor, preencha a posição')"
        oninput="this.setCustomValidity('')">
        <label>Altura</label>
        <input type="number" name="altura" id="altura" placeholder="Ex: 1.80"min="1" max="2.5" step="0.01" required
         oninvalid="this.setCustomValidity('Informe uma altura válida (mínimo 0.60m e máximo 2.50m)')"
        oninput="this.setCustomValidity('')">
        <label>Força</label>
        <input type="number" name="forca" id="forca" placeholder="de 1 a 5" min="1" max="5" required
         oninvalid="this.setCustomValidity('Força deve estar entre 1 e 5')"
        oninput="this.setCustomValidity('')">
        <label>Impulsão</label>
        <input type="number" name="implusao" id="implusao" placeholder="de 1 a 5" min="1" max="5" required
         oninvalid="this.setCustomValidity('Impulsão deve estar entre 1 e 5')"
        oninput="this.setCustomValidity('')">
        <label>Velocidade</label>
        <input type="number" name="velocidade" id="velocidade" placeholder="de 1 a 5" min="1" max="5" required 
        oninvalid="this.setCustomValidity('Velocidade deve estar entre 1 e 5')"
        oninput="this.setCustomValidity('')">
        <label>Resistência</label>
        <input type="number" name="resistencia" id="resistencia" placeholder="de 1 a 5" min="1" max="5" required 
        oninvalid="this.setCustomValidity('Resistência deve estar entre 1 e 5')"
        oninput="this.setCustomValidity('')">
        <label>Arremesso</label>
        <input type="number" name="arremesso" id="arremesso" placeholder="de 1 a 5" min="1" max="5" required 
        oninvalid="this.setCustomValidity('Arremesso deve estar entre 1 e 5')"
        oninput="this.setCustomValidity('')">
        <input type="submit" value="cadastrar atleta">
        <input type="reset" value="limpar">
    </form>
</div>  
    <script>
      
    async function trataForma() {
        const id = document.getElementById("id").value;
        const nome = document.getElementById("nome").value;
        const idade = document.getElementById("idade").value;
        const posicao = document.getElementById("posicao").value;
        const altura = document.getElementById("altura").value;
        const forca = document.getElementById("forca").value;
        const impulsao = document.getElementById("implusao").value;
        const velocidade = document.getElementById("velocidade").value;
        const resistencia = document.getElementById("resistencia").value;
        const arremesso = document.getElementById("arremesso").value;

        const objAtleta = {
            id,
            nome,
            idade,
            posicao,
            altura,
            forca,
            impulsao,
            velocidade,
            resistencia,
            arremesso
        };

        try {
            const resposta = await fetch("http://localhost:8001/atletas", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(objAtleta)
            });

            if (resposta.status === 200 || resposta.status === 201) {
                alert("Atleta cadastrado com sucesso!");
            } else if (resposta.status === 400) {
                const dados = await resposta.json();
                alert("Erro no cadastro:\n" + dados.mensagem);
            } else {
                alert("Erro desconhecido ao cadastrar atleta.");
            }
        } catch (erro) {
            console.error(erro);
            alert("Erro na requisição POST. O backend está rodando com `npm run dev`?");
        }
    }
    </script>
       
  <footer>
    <a href="https://github.com/Teylorrrr" id="footer_copyright" target="_blank" style="text-decoration: none; color: inherit;">
      &#169; 2023 Desenvolvimento por Teylor 1023B
    </a>    
  </footer>
</body>
</html>
