<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="style.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" />
  <title>Comparar Atletas</title>
</head>
<body>
  <header>
    <i class="fa-regular fa-face-smile" style="color: #dedede;"></i>
    <h1>CADASTRE SEU ATLETA</h1>
    <nav>
      <a href="index.html">ATLETAS</a>
      <a href="buscar.html">BUSCAR</a>
      <a href="cadastro.html">CADASTRE</a>
      <a href="listar.html">LISTA</a>
      <a href="destaques.html">DESTAQUES</a>
      <a href="comparar.html">COMPARAR</a>
    </nav>
  </header>

  

  <main>
    <section>
      <h2>Comparar Atletas</h2>
      <label for="atleta1">Primeiro atleta (ID):</label>
      <select id="atleta1"></select>

      <label for="atleta2">Segundo atleta (ID):</label>
      <select id="atleta2"></select>

      <button onclick="comparar()">Comparar</button>
      <button onclick="limparGrafico()">Limpar Gráfico</button>
      <div id="area-graficos"></div>
    </section>
  </main>

  <script>
    let chart = null;

    async function carregarAtletas() {
      const resposta = await fetch("http://localhost:8001/atletas");
      const atletas = await resposta.json();

      const select1 = document.getElementById("atleta1");
      const select2 = document.getElementById("atleta2");

      atletas.forEach(atleta => {
        const option = new Option(`${atleta.id} - ${atleta.nome}`, atleta.id);
        select1.add(option.cloneNode(true));
        select2.add(option.cloneNode(true));
      });
    }

    async function comparar() {
      const id1 = document.getElementById("atleta1").value;
      const id2 = document.getElementById("atleta2").value;

      if (id1 === id2) {
        alert("Selecione dois atletas diferentes.");
        return;
      }

      const atleta1 = await buscarAtletaPorId(id1);
      const atleta2 = await buscarAtletaPorId(id2);
      if (!atleta1 || !atleta2) return;

      const labels = ['Força', 'Impulsão', 'Velocidade', 'Resistência', 'Arremesso'];
      const dados1 = [atleta1.forca, atleta1.impulsao, atleta1.velocidade, atleta1.resistencia, atleta1.arremesso];
      const dados2 = [atleta2.forca, atleta2.impulsao, atleta2.velocidade, atleta2.resistencia, atleta2.arremesso];

      const config = {
        type: 'radar',
        data: {
          labels,
          datasets: [
            {
              label: atleta1.nome,
              data: dados1,
              fill: true,
              backgroundColor: "rgba(255, 99, 132, 0.2)",
              borderColor: "rgb(255, 99, 132)",
              pointBackgroundColor: "rgb(255, 99, 132)"
            },
            {
              label: atleta2.nome,
              data: dados2,
              fill: true,
              backgroundColor: "rgba(54, 162, 235, 0.2)",
              borderColor: "rgb(54, 162, 235)",
              pointBackgroundColor: "rgb(54, 162, 235)"
            }
          ]
        },
        options: {
          elements: { line: { borderWidth: 3 } }
        }
      };

      if (chart) chart.destroy();

      const areaGraficos = document.getElementById("area-graficos");
      areaGraficos.innerHTML = ""; // limpa área
      const novoCanvas = document.createElement("canvas");
      novoCanvas.id = "graficoRadar";
      areaGraficos.appendChild(novoCanvas);

      const ctx = novoCanvas.getContext("2d");
      chart = new Chart(ctx, config);
    }

    function limparGrafico() {
      if (chart) {
        chart.destroy();
        chart = null;
      }
      document.getElementById("area-graficos").innerHTML = "";
    }

    carregarAtletas();
  </script>

  <footer>
    <div id="footer_copyright">
      &#169 2023 Desenvolvimento por Teylor 1023B
    </div>
  </footer>
</body>
</html>

